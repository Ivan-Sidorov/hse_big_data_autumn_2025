Ожидание доступности HDFS...
Попытка 1/60: HDFS недоступен, ожидание...
Попытка 2/60: HDFS недоступен, ожидание...
Попытка 3/60: HDFS недоступен, ожидание...
HDFS доступен!
Ожидание доступности YARN ResourceManager...
YARN доступен!

==========================================
Текущее состояние HDFS перед выполнением задач:
==========================================

==========================================
ЗАДАНИЕ 1: Создание директории /createme
==========================================
Директория /createme создана
drwxr-xr-x   - hdfs supergroup          0 2025-11-17 20:38 /createme

==========================================
ЗАДАНИЕ 2: Удаление директории /delme
==========================================
Директория /delme удалена

==========================================
ЗАДАНИЕ 3: Создание файла /nonnull.txt
==========================================
Файл /nonnull.txt создан

==========================================
ЗАДАНИЕ 4.1: Создание файла /shadow.txt
==========================================
Файл /shadow.txt создан

==========================================
ЗАДАНИЕ 4.2: Выполнение MapReduce WordCount
==========================================
2025-11-17 20:38:30,564 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at resourcemanager/127.0.0.1:8032
2025-11-17 20:38:30,876 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/hdfs/.staging/job_1763411882245_0001
2025-11-17 20:38:31,051 INFO input.FileInputFormat: Total input files to process : 1
2025-11-17 20:38:33,397 INFO mapreduce.JobSubmitter: number of splits:1
2025-11-17 20:38:33,510 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1763411882245_0001
2025-11-17 20:38:33,510 INFO mapreduce.JobSubmitter: Executing with tokens: []
2025-11-17 20:38:33,612 INFO conf.Configuration: resource-types.xml not found
2025-11-17 20:38:33,612 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2025-11-17 20:38:33,789 INFO impl.YarnClientImpl: Submitted application application_1763411882245_0001
2025-11-17 20:38:33,815 INFO mapreduce.Job: The url to track the job: http://any:8088/proxy/application_1763411882245_0001/
2025-11-17 20:38:33,816 INFO mapreduce.Job: Running job: job_1763411882245_0001
2025-11-17 20:38:40,036 INFO mapreduce.Job: Job job_1763411882245_0001 running in uber mode : false
2025-11-17 20:38:40,039 INFO mapreduce.Job:  map 0% reduce 0%
2025-11-17 20:38:45,127 INFO mapreduce.Job:  map 100% reduce 0%
2025-11-17 20:38:49,216 INFO mapreduce.Job:  map 100% reduce 100%
2025-11-17 20:38:51,232 INFO mapreduce.Job: Job job_1763411882245_0001 completed successfully
2025-11-17 20:38:51,478 INFO mapreduce.Job: Counters: 54
        File System Counters
                FILE: Number of bytes read=1128
                FILE: Number of bytes written=556045
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=812
                HDFS: Number of bytes written=754
                HDFS: Number of read operations=8
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=2
                HDFS: Number of bytes read erasure-coded=0
        Job Counters
                Launched map tasks=1
                Launched reduce tasks=1
                Data-local map tasks=1
                Total time spent by all maps in occupied slots (ms)=2223
                Total time spent by all reduces in occupied slots (ms)=1552
                Total time spent by all map tasks (ms)=2223
                Total time spent by all reduce tasks (ms)=1552
                Total vcore-milliseconds taken by all map tasks=2223
                Total vcore-milliseconds taken by all reduce tasks=1552
                Total megabyte-milliseconds taken by all map tasks=2276352
                Total megabyte-milliseconds taken by all reduce tasks=1589248
        Map-Reduce Framework
                Map input records=3
                Map output records=124
                Map output bytes=1216
                Map output materialized bytes=1128
                Input split bytes=91
                Combine input records=124
                Combine output records=92
                Reduce input groups=92
                Reduce shuffle bytes=1128
                Reduce input records=92
                Reduce output records=92
                Spilled Records=184
                Shuffled Maps =1
                Failed Shuffles=0
                Merged Map outputs=1
                GC time elapsed (ms)=45
                CPU time spent (ms)=660
                Physical memory (bytes) snapshot=529719296
                Virtual memory (bytes) snapshot=10268434432
                Total committed heap usage (bytes)=528482304
                Peak Map Physical memory (bytes)=313470976
                Peak Map Virtual memory (bytes)=4925517824
                Peak Reduce Physical memory (bytes)=216248320
                Peak Reduce Virtual memory (bytes)=5342916608
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters
                Bytes Read=721
        File Output Format Counters
                Bytes Written=754

==========================================
ЗАДАНИЕ 5: Запись числа вхождений 'Innsmouth'
==========================================
Число вхождений 'Innsmouth' записано в /whataboutinsmouth.txt

==========================================
Валидация результата
==========================================
Текущие файлы в HDFS:
Found 6 items
drwxr-xr-x   - hdfs supergroup          0 2025-11-17 20:38 /createme
-rw-r--r--   1 hdfs supergroup         27 2025-11-17 20:38 /nonnull.txt
-rw-r--r--   1 hdfs supergroup        721 2025-11-17 20:38 /shadow.txt
drwxr-xr-x   - hdfs supergroup          0 2025-11-17 20:38 /tmp
-rw-r--r--   1 hdfs supergroup          2 2025-11-17 20:38 /whataboutinsmouth.txt
drwxr-xr-x   - hdfs supergroup          0 2025-11-17 20:38 /wordcount_output

Содержимое файла /whataboutinsmouth.txt:
6

MR wordcount результаты:
By      1
He      1
Innsmouth       6
October 1
The     2
They    1
When    1
a       4
about   1
accepted        1
air.    1
an      1
and     2
another 1
arrived 1
at      2
before  1
biting  1
brine   1
but     1
coastal 1
decay   1
different       1
doorways,       1
dying   1
echoed  1
either. 1
eyes    1
fallen  1
finally 1
fish    1
from    1
gray    1
greenish        1
grown   1
had     4
hard    1
he      4
heard   1
heavy   1
him     1
himself 1
his     1
hung    1
in      2
just    1
keeper  2
lasted  1
light.  1
lighthouse      1